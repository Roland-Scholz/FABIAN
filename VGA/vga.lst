
ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 1





       MCS-51 Family Macro Assembler   A S E M - 5 1   V 1.3
       =====================================================



	Source File:	C:\github\fabian\VGA\vga.a51
	Object File:	C:\github\fabian\VGA\vga.hex
	List File:	C:\github\fabian\VGA\vga.lst



 Line  I  Addr  Code            Source

    1:						$NOMOD51
    2:						$INCLUDE (89S52.MCU)
    3: 1			;   AT89S52 processor definition file
    4: 1			;   =================================
    5: 1
    6: 1	N	 80	P0	DATA	080H
    7: 1	N	 81	SP	DATA	081H
    8: 1	N	 82	DP0L	DATA	082H
    9: 1	N	 83	DP0H	DATA	083H
   10: 1	N	 84	DP1L	DATA	084H
   11: 1	N	 85	DP1H	DATA	085H
   12: 1	N	 87	PCON	DATA	087H
   13: 1	N	 88	TCON	DATA	088H
   14: 1	N	 89	TMOD	DATA	089H
   15: 1	N	 8A	TL0	DATA	08AH
   16: 1	N	 8B	TL1	DATA	08BH
   17: 1	N	 8C	TH0	DATA	08CH
   18: 1	N	 8D	TH1	DATA	08DH
   19: 1	N	 8E	AUXR	DATA	08EH
   20: 1	N	 90	P1	DATA	090H
   21: 1	N	 98	SCON	DATA	098H
   22: 1	N	 99	SBUF	DATA	099H
   23: 1	N	 A0	P2	DATA	0A0H
   24: 1	N	 A2	AUXR1	DATA	0A2H
   25: 1	N	 A6	WDTRST	DATA	0A6H
   26: 1	N	 A8	IE	DATA	0A8H
   27: 1	N	 B0	P3	DATA	0B0H
   28: 1	N	 B8	IP	DATA	0B8H
   29: 1	N	 C8	T2CON	DATA	0C8H
   30: 1	N	 C9	T2MOD	DATA	0C9H
   31: 1	N	 CA	RCAP2L	DATA	0CAH
   32: 1	N	 CB	RCAP2H	DATA	0CBH
   33: 1	N	 CC	TL2	DATA	0CCH
   34: 1	N	 CD	TH2	DATA	0CDH
   35: 1	N	 D0	PSW	DATA	0D0H
   36: 1	N	 E0	ACC	DATA	0E0H
   37: 1	N	 F0	B	DATA	0F0H
   38: 1
   39: 1	N	 88	IT0	BIT	088H
   40: 1	N	 89	IE0	BIT	089H
   41: 1	N	 8A	IT1	BIT	08AH
   42: 1	N	 8B	IE1	BIT	08BH
   43: 1	N	 8C	TR0	BIT	08CH

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 2



 Line  I  Addr  Code            Source

   44: 1	N	 8D	TF0	BIT	08DH
   45: 1	N	 8E	TR1	BIT	08EH
   46: 1	N	 8F	TF1	BIT	08FH
   47: 1	N	 90	T2	BIT	090H
   48: 1	N	 91	T2EX	BIT	091H
   49: 1	N	 95	MOSI	BIT	095H
   50: 1	N	 96	MISO	BIT	096H
   51: 1	N	 97	SCK	BIT	097H
   52: 1	N	 98	RI	BIT	098H
   53: 1	N	 99	TI	BIT	099H
   54: 1	N	 9A	RB8	BIT	09AH
   55: 1	N	 9B	TB8	BIT	09BH
   56: 1	N	 9C	REN	BIT	09CH
   57: 1	N	 9D	SM2	BIT	09DH
   58: 1	N	 9E	SM1	BIT	09EH
   59: 1	N	 9F	SM0	BIT	09FH
   60: 1	N	 A8	EX0	BIT	0A8H
   61: 1	N	 A9	ET0	BIT	0A9H
   62: 1	N	 AA	EX1	BIT	0AAH
   63: 1	N	 AB	ET1	BIT	0ABH
   64: 1	N	 AC	ES	BIT	0ACH
   65: 1	N	 AD	ET2	BIT	0ADH
   66: 1	N	 AF	EA	BIT	0AFH
   67: 1	N	 B0	RXD	BIT	0B0H
   68: 1	N	 B1	TXD	BIT	0B1H
   69: 1	N	 B2	INT0	BIT	0B2H
   70: 1	N	 B3	INT1	BIT	0B3H
   71: 1	N	 B4	T0	BIT	0B4H
   72: 1	N	 B5	T1	BIT	0B5H
   73: 1	N	 B6	WR	BIT	0B6H
   74: 1	N	 B7	RD	BIT	0B7H
   75: 1	N	 B8	PX0	BIT	0B8H
   76: 1	N	 B9	PT0	BIT	0B9H
   77: 1	N	 BA	PX1	BIT	0BAH
   78: 1	N	 BB	PT1	BIT	0BBH
   79: 1	N	 BC	PS	BIT	0BCH
   80: 1	N	 BD	PT2	BIT	0BDH
   81: 1	N	 C8	CPRL2	BIT	0C8H
   82: 1	N	 C9	CT2	BIT	0C9H
   83: 1	N	 CA	TR2	BIT	0CAH
   84: 1	N	 CB	EXEN2	BIT	0CBH
   85: 1	N	 CC	TCLK	BIT	0CCH
   86: 1	N	 CD	RCLK	BIT	0CDH
   87: 1	N	 CE	EXF2	BIT	0CEH
   88: 1	N	 CF	TF2	BIT	0CFH
   89: 1	N	 D0	P	BIT	0D0H
   90: 1	N	 D2	OV	BIT	0D2H
   91: 1	N	 D3	RS0	BIT	0D3H
   92: 1	N	 D4	RS1	BIT	0D4H
   93: 1	N	 D5	F0	BIT	0D5H
   94: 1	N	 D6	AC	BIT	0D6H
   95: 1	N	 D7	CY	BIT	0D7H
   96: 1
   97: 1	N      0000	RESET	CODE	000H
   98: 1	N      0003	EXTI0	CODE	003H
   99: 1	N      000B	TIMER0	CODE	00BH

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 3



 Line  I  Addr  Code            Source

  100: 1	N      0013	EXTI1	CODE	013H
  101: 1	N      001B	TIMER1	CODE	01BH
  102: 1	N      0023	SINT	CODE	023H
  103: 1	N      002B	TIMER2	CODE	02BH
  104:						$INCLUDE (PAULMON.INC)
  105: 1	N      002E	phex1		EQU 002Eh		;print a single hex digit
  106: 1	N      0030	cout		EQU 0030h            	;Send Acc to serial port
  107: 1	N      0032	cin		EQU 0032h             	;Get Acc from serial port
  108: 1	N      0034	phex		EQU 0034h            	;Print Hex value of Acc
  109: 1	N      0036	phex16		EQU 0036h          	;Print Hex value of DPTR
  110: 1	N      0038	pstr		EQU 0038h            	;Print string pointed to by DPTR,
  111: 1			                                	;must be terminated by 0 or a high bit set
  112: 1			                                	;pressing ESC will stop the printing
  113: 1	N      003A	ghex		EQU 003Ah            	;Get Hex input into Acc
  114: 1			                                	;Carry set if ESC has been pressed
  115: 1	N      003C	ghex16		EQU 003Ch          	;Get Hex input into DPTR
  116: 1			                                	;Carry set if ESC has been pressed
  117: 1	N      003E	esc		EQU 003Eh             	;Check for ESC key
  118: 1								;Carry set if ESC has been pressed
  119: 1	N      0040	upper		EQU 0040h           	;Convert Acc to uppercase
  120: 1								;Non-ASCII values are unchanged
  121: 1	N      0042	autobaud	EQU 0042h        	;Initialize serial port
  122: 1	N      0045	pcstr		EQU 0045h		;print string in compressed format (no docs)
  123: 1	N      0045	pcstr_h		EQU 0045h
  124: 1	N      0048	newline		EQU 0048h		;print CR/LF (13 and 10)
  125: 1	N      004A	lenstr		EQU 004Ah		;return the length of a string @DPTR (in R0)
  126: 1	N      004D	pint8u		EQU 004Dh		;print Acc at an integer, 0 to 255
  127: 1	N      0050	pint8		EQU 0050h		;print Acc at an integer, -128 to 127
  128: 1	N      0053	pint16u		EQU 0053h		;print DPTR as an integer, 0 to 65535
  129: 1	N      0056	smart_wr	EQU 0056h		;write Acc @DPTR (RAM or flash), C=1 if error
  130: 1	N      0059	prgm		EQU 0059h		;write Acc @DPTR to Flash ROM, C=1 if error
  131: 1	N      005C	erall		EQU 005Ch		;erase the Flash ROM chip, C=1 if error
  132: 1	N      005F	find		EQU 005Fh		;find next prog header in memory
  133: 1	N      0062	cin_filter	EQU 0062h		;like cin, but scan for arrow keys, pgup/pgdn
  134: 1	N      0065	asc2hex		EQU 0065h		;convert character 0-9,A-F to number 0-15.
  135:						$INCLUDE (COMMON.INC)
  136: 1	N      9800	MEMDUMP2	EQU	9800h
  137: 1	N      9802	MEMDUMP4	EQU	9802h
  138: 1	N      9804	MEMDUMP128	EQU	9804h
  139: 1	N      9806	MEMDUMP512	EQU	9806h
  140: 1	N      9808	MEMCLR4		EQU	9808h
  141: 1	N      980A	MEMCLR		EQU	980Ah
  142: 1	N      980C	MEMFILL		EQU	980Ch
  143: 1	N      980E	MEMCMP		EQU	980Eh
  144: 1	N      9810	MEMINTC2	EQU	9810h
  145: 1	N      9812	MEMINTC4	EQU	9812h
  146: 1	N      9814	MEMINTC		EQU	9814h
  147: 1
  148: 1	N      9816	INTDIV3		EQU	9816h
  149: 1	N      9818	INTMUL4		EQU	9818h
  150: 1	N      981A	INTCMP4		EQU	981Ah
  151: 1	N      981C	INTCMP		EQU	981Ch
  152: 1	N      981E	INTCOPY2	EQU	981Eh
  153: 1	N      9820	INTCOPY4	EQU	9820h
  154: 1	N      9822	INTCOPY		EQU	9822h
  155: 1	N      9824	INTSUB2		EQU	9824h

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 4



 Line  I  Addr  Code            Source

  156: 1	N      9826	INTSUB4		EQU	9826h
  157: 1	N      9828	INTSUB		EQU	9828h
  158: 1	N      982A	INTADD4		EQU	982Ah
  159: 1	N      982C	INTADD		EQU	982Ch
  160: 1	N      982E	INTCLR4		EQU	982Eh
  161: 1	N      9830	INTCLR		EQU	9830h
  162: 1	N      9832	INTFILL		EQU	9832h
  163: 1
  164: 1	N      9834	MEMINTA4	EQU	9834h
  165: 1	N      9836	MEMINTA2	EQU	9836h
  166: 1
  167: 1	N      9838	INTDUMP6	EQU	9838h
  168: 1	N      983A	INTDUMP4	EQU	983Ah
  169: 1	N      983C	INTDUMP2	EQU	983Ch
  170: 1	N      983E	INTDUMP		EQU	983Eh
  171: 1
  172: 1	N      9840	ADDDPTR0	EQU	9840h
  173: 1
  174: 1	N      9842	MEMCOPY		EQU	9842h
  175: 1	N      9844	MEMDUMP		EQU	9844h
  176: 1	N      9846	MEMCOPY4	EQU	9846h
  177: 1	N      9848	PSTRR7		EQU	9848h
  178: 1
  179: 1	N      984A	STRCOPY		EQU	984Ah
  180:
  181:		D      0090	DATABUS		EQU	P1
  182:
  183:		B      00B2	SYCS		EQU	P3.2
  184:		B      00B3	SYRS		EQU	P3.3
  185:		B      00B4	SYPHI2		EQU	P3.4
  186:		B      00B5	SYRW		EQU	P3.5
  187:
  188:
  189:		D      0082	dpl		EQU	DP0L
  190:		D      0083	dph		EQU	DP0H
  191:
  192:		N      6000	LOCAT		EQU	06000h
  193:
  194:		N      6000			ORG    LOCAT
  195:	  6000	A5 E5 E0 A5			DB     0A5H,0E5H,0E0H,0A5H	;SIGNITURE BYTES
  196:	  6004	23 00 00 00			DB     35,0,0,0			;ID (35=PROG), id (253=startup)
  197:	  6008	00 00 00 00			DB     0,0,0,0			;PROMPT CODE VECTOR
  198:	  600C	00 00 00 00			DB     0,0,0,0			;RESERVED
  199:	  6010	00 00 00 00			DB     0,0,0,0			;RESERVED
  200:	  6014	00 00 00 00			DB     0,0,0,0			;RESERVED
  201:	  6018	00 00 00 00			DB     0,0,0,0			;USER DEFINED
  202:	  601C	FF FF FF FF			DB     255,255,255,255		;LENGTH AND CHECKSUM (255=UNUSED)
  203:	  6020	53 59 36 38			DB     "SY6845",0		;MAX 31 CHARACTERS, PLUS THE ZERO
	  6024	34 35 00
  204:
  205:		N      6040			ORG    LOCAT+64			;EXECUTABLE CODE BEGINS HERE
  206:
  207:				;
  208:				;
  209:				;
  210:	  6040			START:		;sjmp	START1

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 5



 Line  I  Addr  Code            Source

  211:	  6040	C2 B5				clr	T1			;E 6845 = low
  212:	  6042	C2 B4				clr	T0			;0=display mode, 1=CRT mode
  213:	  6044	C2 B2				clr	INT0			;charset 0
  214:	  6046	C2 B3				clr	INT1			;screen 0
  215:	  6048	75 A2 00			mov	AUXR1, #0
  216:
  217:	  604B	80 00				sjmp	start2
  218:
  219:				;		mov	dptr, #8000h
  220:				;start1:		movx	@dptr, a
  221:				;		nop
  222:				;		push	acc
  223:				;		call	phex
  224:				;		mov	a, P1
  225:				;		call	phex
  226:				;		pop	acc
  227:
  228:						;cjne	a, P1, error1
  229:				;		inc	a
  230:				;		sjmp	start1
  231:
  232:				;error1:
  233:				;		ret
  234:
  235:	  604D	12 61 47	start2:		call	init6845
  236:	  6050	12 61 12			call	copyFont
  237:
  238:						;ljmp	02000h			;start vt100 program
  239:
  240:						;call	CIN
  241:	  6053	12 60 F7			call	testScreen
  242:	  6056	12 61 A7			call	testram
  243:
  244:	  6059	12 00 32	start3:		call	cin
  245:	  605C	12 60 61			call	scrolup
  246:	  605F	80 F8				sjmp	start3
  247:
  248:	  6061	90 80 00	scrolup:	mov	dptr, #8000h
  249:	  6064	05 A2				inc	auxr1
  250:	  6066	90 80 A0			mov	dptr, #8000h+160
  251:
  252:	  6069	78 18				mov	r0, #24		;1
  253:	  606B	79 A0		scrolup2:	mov	r1, #160	;1
  254:
  255:	  606D	E0		scrolup1:	movx	a, @dptr	;2
  256:	  606E	E5 90				mov	a, databus	;1
  257:	  6070	A3				inc	dptr		;2
  258:	  6071	05 A2				inc	auxr1		;1
  259:
  260:	  6073	F0				movx	@dptr, a	;2
  261:	  6074	A3				inc	dptr		;2
  262:	  6075	05 A2				inc	auxr1		;1
  263:
  264:	  6077	D9 F4				djnz	r1, scrolup1	;2	13x160 = 2080
  265:	  6079	D8 F0				djnz	r0, scrolup2	;2	24 x (3 + 2080) = 49992, * 0,543uS = 27,2ms
  266:

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 6



 Line  I  Addr  Code            Source

  267:	  607B	79 A0				mov	r1, #160
  268:	  607D	05 A2				inc	auxr1
  269:	  607F	E4				clr	a
  270:	  6080	F0		scrolup3:	movx	@dptr, a
  271:	  6081	A3				inc	dptr
  272:	  6082	D9 FC				djnz	r1, scrolup3
  273:
  274:	  6084	22				ret			;	22,1184Mhz = 0,543 uS
  275:
  276:	  6085	12 00 32	regs:		call	CIN
  277:	  6088	B4 0D 04			cjne	A, #13, regs4
  278:	  608B	12 61 A7			call	testram
  279:	  608E	22				ret
  280:
  281:	  608F	C3		regs4:		clr	C
  282:	  6090	94 30				subb	A, #'0'
  283:	  6092	F8				mov	R0, A
  284:	  6093	12 00 34			call	PHEX
  285:	  6096	90 61 7F			mov	DPTR, #SYDATA
  286:	  6099	93				movc	A, @A+DPTR
  287:	  609A	F9				mov	R1, A
  288:	  609B	12 00 34			call	PHEX
  289:
  290:	  609E	12 00 32	regs3:		call	CIN
  291:	  60A1	B4 2D 03			cjne	A, #'-',regs1
  292:	  60A4	19				dec	R1
  293:	  60A5	01 B3				ajmp	regsset
  294:	  60A7	B4 2B 03	regs1:		cjne	A, #'+', regs2
  295:	  60AA	09				inc	R1
  296:	  60AB	01 B3				ajmp	regsset
  297:	  60AD	B4 78 EE	regs2:		cjne	A, #'x', regs3
  298:	  60B0	02 60 85			ljmp	regs
  299:
  300:	  60B3	74 7F		regsset:	mov	A, #LOW SYDATA
  301:	  60B5	28				add	A, R0
  302:	  60B6	F5 82				mov	DP0L, A
  303:	  60B8	74 61				mov	A, #HIGH SYDATA
  304:	  60BA	34 00				addc	A, #0
  305:	  60BC	F5 83				mov	DP0H, A
  306:	  60BE	E9				mov	A, R1
  307:	  60BF	12 00 34			call	PHEX
  308:	  60C2	F0				movx	@DPTR, A
  309:
  310:	  60C3	D2 B4				setb	T0
  311:	  60C5	90 80 00			mov	DPTR, #8000h
  312:	  60C8	E8				mov	A, R0
  313:	  60C9	F0				movx	@DPTR, A
  314:	  60CA	D2 B5				setb	T1
  315:	  60CC	C2 B5				clr	T1
  316:	  60CE	A3				inc	DPTR
  317:	  60CF	E9				mov	A, R1
  318:	  60D0	F0				movx	@DPTR, A
  319:	  60D1	D2 B5				setb	T1
  320:	  60D3	C2 B5				clr	T1
  321:	  60D5	C2 B4				clr	T0
  322:	  60D7	01 9E				ajmp	regs3

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 7



 Line  I  Addr  Code            Source

  323:
  324:	  60D9	22				ret
  325:
  326:
  327:	  60DA	90 80 00	dumpRam:	mov	DPTR, #8000h
  328:	  60DD	E0		dumpRam2:	movx	A, @DPTR
  329:	  60DE	E5 90				mov	A, P1
  330:	  60E0	12 00 34			call	PHEX
  331:	  60E3	12 62 18			call	SPACE
  332:	  60E6	A3				inc	DPTR
  333:	  60E7	E5 82				mov	A, DP0L
  334:	  60E9	54 0F				anl	A, #0fh
  335:	  60EB	B4 00 03			cjne	A, #0, dumpRam1
  336:	  60EE	12 00 48			call	newline
  337:	  60F1	E5 83		dumpram1:	mov	A, DP0H
  338:	  60F3	B4 81 E7			cjne	A, #81h, dumpram2
  339:	  60F6	22				ret
  340:
  341:	  60F7	90 80 00	testScreen:	mov	DPTR, #8000h
  342:	  60FA	78 0A				mov	R0, #10
  343:
  344:	  60FC	79 50		testScreen3:	mov	R1, #80
  345:	  60FE	7A 30				mov	R2, #'0'
  346:	  6100	EA		testScreen1:	mov	A, R2
  347:	  6101	F0				movx	@DPTR, A
  348:	  6102	A3				inc	DPTR
  349:	  6103	74 71				mov	A, #71h
  350:						;anl	A, #3
  351:						;orl	A, #0f0h
  352:						;inc	A
  353:	  6105	F0				movx	@DPTR, A
  354:	  6106	A3				inc	DPTR
  355:	  6107	0A				inc	R2
  356:	  6108	BA 3A 02			cjne	R2, #'9'+1, testScreen2
  357:	  610B	7A 30				mov	R2, #'0'
  358:	  610D	D9 F1		testScreen2:	djnz	R1, testScreen1
  359:	  610F	D8 EB				djnz	R0, testScreen3
  360:	  6111	22				ret
  361:				;
  362:				;
  363:				;
  364:	  6112			copyFont:
  365:	  6112	90 70 00			mov	DPTR, #7000h
  366:	  6115	05 A2				inc	AUXR1
  367:	  6117	90 A0 00			mov	DPTR, #(8000h+2000h) ;+4000h+1000h
  368:	  611A	05 A2				inc	AUXR1
  369:
  370:	  611C	E4		copyFont1:	clr	A
  371:	  611D	93				movc	A, @A+DPTR
  372:	  611E	A3				inc	DPTR
  373:	  611F	05 A2				inc	AUXR1
  374:	  6121	F0				movx	@DPTR, A
  375:	  6122	A3				inc	DPTR
  376:	  6123	05 A2				inc	AUXR1
  377:
  378:	  6125	E5 83				mov	A, DP0H

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 8



 Line  I  Addr  Code            Source

  379:	  6127	B4 80 F2			cjne	a, #80h, copyFont1
  380:
  381:	  612A	E5 A2				mov	A, AUXR1
  382:	  612C	12 00 34			call	PHEX
  383:	  612F	12 00 48			call	newline
  384:	  6132	22				ret
  385:
  386:
  387:
  388:				;
  389:				;
  390:				;
  391:	  6133			init6845hi:
  392:	  6133	75 83 00			mov	dp0h, #0		;enable ADR + DAT (mode 2)
  393:	  6136	E0				movx	a, @dptr
  394:	  6137	E0				movx	a, @dptr
  395:



  396:	  6138	90 80 00			mov	DPTR, #8000h
  397:	  613B	05 A2				inc	AUXR1
  398:	  613D	90 61 93			mov	DPTR, #highres
  399:	  6140	05 A2				inc	AUXR1
  400:	  6142	78 00				mov	R0, #0
  401:	  6144	12 61 58			call	setregs
  402:
  403:
  404:	  6147	75 83 00	init6845:	mov	dp0h, #0		;enable ADR + DAT (mode 2)
  405:	  614A	E0				movx	a, @dptr
  406:	  614B	E0				movx	a, @dptr
  407:



  408:	  614C	90 80 00			mov	DPTR, #8000h
  409:	  614F	05 A2				inc	AUXR1
  410:	  6151	90 61 7F			mov	DPTR, #SYDATA
  411:	  6154	05 A2				inc	AUXR1
  412:	  6156	78 00				mov	R0, #0
  413:
  414:	  6158			setregs:
  415:	  6158	E8				mov	A, R0			; send address
  416:	  6159	12 00 34			call	PHEX
  417:	  615C	F0				movx	@DPTR,A			; address register
  418:	  615D	D2 B5				setb	T1			; clock high
  419:	  615F	C2 B5				clr	T1			; clock low
  420:	  6161	A3				inc	DPTR			; data reg
  421:
  422:	  6162	05 A2				inc	AUXR1			; data pointer
  423:	  6164	93				movc	A, @A+DPTR
  424:	  6165	12 00 34			call	PHEX
  425:	  6168	05 A2				inc	AUXR1			; address pointer
  426:	  616A	F0				movx	@DPTR, A		; send data
  427:	  616B	D2 B5				setb	T1			; clock high
  428:	  616D	C2 B5				clr	T1			; clock low

ASEM-51 V1.3                                         Copyright (c) 2002 by W.W. Heinz                                         PAGE 9



 Line  I  Addr  Code            Source

  429:
  430:	  616F	12 62 18			call	SPACE
  431:	  6172	A3				inc	DPTR
  432:	  6173	08				inc	R0
  433:	  6174	B8 0F E1			cjne	R0, #15, setregs
  434:
  435:	  6177	75 83 00			mov	dp0h, #0		;disable ADR + DAT(mode 0)
  436:	  617A	E0				movx	a, @dptr
  437:	  617B	E0				movx	a, @dptr



  438:	  617C	02 00 48			ljmp	newline
  439:
  440:
  441:				;
  442:				; 25,333 Mhz / 8 = 3,166 Mhz
  443:				;
  444:				; 31468 HZ = 31,77 uS
  445:				;
  446:				; 25,333 Mhz / 8 / 31468 ~ 	100 chars Horizontal Total
  447:				;				  2 chars Fornt Porch
  448:				;				  6 chars Back Porch
  449:				;				 80 chars Horizontal Visible
  450:				;				 12 chars Sync Pulse
  451:				;Scanline part	Pixels	Time [µs]
  452:				;Visible area	640	25.422045680238
  453:				;Front porch	16	0.63555114200596
  454:				;Sync pulse	96	3.8133068520357
  455:				;Back porch	48	1.9066534260179
  456:				;Whole line	800	31.777557100298
  457:
  458:				;Frame part	Lines	Time [ms]
  459:				;Visible area	400	12.711022840119
  460:				;Front porch	12	0.38133068520357
  461:				;Sync pulse	2	0.063555114200596
  462:				;Back porch	35	1.1122144985104
  463:				;Whole frame	449	14.268123138034
  464:				;
  465:	  617F	64		SYDATA:		DB	100		;R0 Horizontal Total - 1
  466:	  6180	50				DB	80		;R1 Horizontal Displayed
  467:	  6181	54				DB	84		;R2 Horizontal Sync Position
  468:	  6182	0C				DB	0ch		;R3 VSYNC & HSYNC width
  469:	  6183	1C				DB	28		;R4 Vertical total - 1			;27	32
  470:	  6184	05				DB	5		;R5 Vertical Adjust
  471:	  6185	19				DB	25		;R6 Vertical Displayed			;25	30
  472:	  6186	1B				DB	27		;R7 Vertical Sync Position		;25	32
  473:	  6187	00				DB	00h		;R8 Mode Control
  474:	  6188	0F				DB	15		;R9 Scan Lines - 1 (character lines)
  475:	  6189	00				DB	0		;R10 Cursor Start
  476:	  618A	00				DB	0		;R11 Cursor End
  477:	  618B	00				DB	000h		;R12 Display Start High
  478:	  618C	00				DB	000h		;R13 Display Start Low
  479:	  618D	00				DB	0		;R14 Cursor Pos High
  480:	  618E	00				DB	0		;R15 Cursor Pos Low
  481:	  618F	00				DB	0		;R16 Light Pen High

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 10



 Line  I  Addr  Code            Source

  482:	  6190	00				DB	0		;R17 Light Pen Low
  483:	  6191	00				DB	0		;R18 Update Address Reg High
  484:	  6192	00				DB	0		;R19 Update Address Reg Low
  485:									;R31 Dummy Register
  486:
  487:	  6193	32		highres:	DB	50		;R0 Horizontal Total - 1
  488:	  6194	28				DB	40		;R1 Horizontal Displayed
  489:	  6195	29				DB	41		;R2 Horizontal Sync Position
  490:	  6196	0C				DB	0ch		;R3 VSYNC & HSYNC width
  491:	  6197	1C				DB	28		;R4 Vertical total - 1			;27	32
  492:	  6198	05				DB	5		;R5 Vertical Adjust
  493:	  6199	19				DB	25		;R6 Vertical Displayed			;25	30
  494:	  619A	1B				DB	27		;R7 Vertical Sync Position		;25	32
  495:	  619B	00				DB	00h		;R8 Mode Control
  496:	  619C	0F				DB	15		;R9 Scan Lines - 1 (character lines)
  497:	  619D	00				DB	0		;R10 Cursor Start
  498:	  619E	00				DB	0		;R11 Cursor End
  499:	  619F	00				DB	000h		;R12 Display Start High
  500:	  61A0	00				DB	000h		;R13 Display Start Low
  501:	  61A1	00				DB	0		;R14 Cursor Pos High
  502:	  61A2	00				DB	0		;R15 Cursor Pos Low
  503:	  61A3	00				DB	0		;R16 Light Pen High
  504:	  61A4	00				DB	0		;R17 Light Pen Low
  505:	  61A5	00				DB	0		;R18 Update Address Reg High
  506:	  61A6	00				DB	0		;R19 Update Address Reg Low
  507:									;R31 Dummy Register
  508:
  509:	  61A7			testram:
  510:	  61A7	78 00				mov	R0, #00h
  511:	  61A9	79 00				mov	R1, #00h
  512:	  61AB	7A 80				mov	R2, #80h
  513:
  514:	  61AD	12 61 C1	testloop:	call	writepage
  515:	  61B0	FC				mov	R4, A
  516:	  61B1	12 61 E7	testloop1:	call	readpage
  517:	  61B4	B5 04 FA			cjne	A, 4, testloop1
  518:	  61B7	12 00 48			call	newline
  519:
  520:	  61BA	09				inc	R1
  521:				;		inc	R2
  522:	  61BB	B9 20 EF			cjne	R1, #20h, testloop
  523:	  61BE	21 A7				ajmp	testram
  524:
  525:	  61C0	22		error:		ret
  526:
  527:
  528:
  529:	  61C1	E9		writepage:	mov	A, R1
  530:	  61C2	12 00 34			call	PHEX
  531:	  61C5	E8				mov	A, R0
  532:	  61C6	12 00 34			call	PHEX
  533:	  61C9	12 62 18			call	space
  534:	  61CC	EA				mov	A, R2
  535:	  61CD	12 00 34			call	PHEX
  536:	  61D0	12 62 18			call	space
  537:

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 11



 Line  I  Addr  Code            Source

  538:	  61D3	7B 00				mov	R3, #00h
  539:	  61D5	E4		tp0:		clr	A
  540:	  61D6	88 82				mov	DP0L, R0
  541:	  61D8	89 83				mov	DP0H, R1
  542:	  61DA	93				movc	A, @A+DPTR
  543:				;		push	ACC
  544:				;		call	PHEX
  545:				;		call	SPACE
  546:				;		pop	ACC
  547:	  61DB	8A 83				mov	DP0H, R2
  548:	  61DD	F0				movx	@dptr, A
  549:	  61DE	2B				add	A, R3
  550:	  61DF	FB				mov	R3, A
  551:	  61E0	D8 F3				djnz	R0, tp0
  552:
  553:				;		call	newline
  554:	  61E2	EB				mov	A, R3
  555:	  61E3	12 00 34			call	PHEX
  556:	  61E6	22				ret
  557:
  558:
  559:	  61E7	7B 00		readpage:	mov	R3, #00h
  560:	  61E9	8A 83		 		mov	DP0H, R2
  561:	  61EB	88 82		tp1: 		mov	DP0L, R0
  562:
  563:	  61ED	E0				movx	A, @dptr
  564:				;		nop
  565:				;		nop
  566:	  61EE	E5 90				mov	A, P1
  567:				;		push	ACC
  568:				;		call	PHEX
  569:				;		call	SPACE
  570:				;		pop	ACC
  571:	  61F0	2B				add	A, R3
  572:	  61F1	FB				mov	R3, A
  573:	  61F2	D8 F7				djnz	R0, tp1
  574:
  575:	  61F4	12 62 18			call	space
  576:	  61F7	EB				mov	A, R3
  577:	  61F8	12 00 34			call	PHEX
  578:
  579:	  61FB	22				ret
  580:				;
  581:				;
  582:				;		;setb	SYCS			;deselect
  583:	  61FC	C2 B3				clr	SYRS			;address
  584:	  61FE	C2 B4				clr	SYPHI2			;enable
  585:						;clr	SYRW			;write
  586:
  587:	  6200	04		loop:		inc	A
  588:	  6201	F5 90				mov	DATABUS, A		; send data
  589:	  6203	D2 B3				setb	SYRS			; register data
  590:	  6205	D2 B4				setb	SYPHI2			; clock high
  591:	  6207	C2 B4				clr	SYPHI2			; clock low
  592:	  6209	51 0D				acall	time
  593:	  620B	41 00				ajmp	loop

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 12



 Line  I  Addr  Code            Source

  594:
  595:	  620D	78 00		time:		mov	R0, #0
  596:	  620F	79 00				mov	R1, #0
  597:	  6211	D8 FE		time1:		djnz	r0, time1
  598:	  6213	D9 FC				djnz	r1, time1
  599:	  6215	22				ret
  600:
  601:
  602:				;LOOP:		call	CIN
  603:				;		call	COUT
  604:				;
  605:	  6216	41 00				ajmp	LOOP
  606:
  607:
  608:	  6218	C0 E0		space:		push	ACC
  609:	  621A	74 20				mov	a, #' '
  610:	  621C	12 00 30			call	COUT
  611:	  621F	D0 E0				pop	ACC
  612:	  6221	22				ret
  613:
  614:						END





                     register banks used:  ---

                     no errors




ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 13





	       L I S T   O F   S Y M B O L S
	       =============================


SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
??ASEM_51			  NUMBER    8051
??VERSION			  NUMBER    0130
AC				  BIT	      D6	  94
ACC				  DATA	      E0	  36
ADDDPTR0			  NUMBER    9840	 172
ASC2HEX				  NUMBER    0065	 134
AUTOBAUD			  NUMBER    0042	 121
AUXR				  DATA	      8E	  19
AUXR1				  DATA	      A2	  24
B				  DATA	      F0	  37
CIN				  NUMBER    0032	 107
CIN_FILTER			  NUMBER    0062	 133
COPYFONT			  CODE	    6112	 364
COPYFONT1			  CODE	    611C	 370
COUT				  NUMBER    0030	 106
CPRL2				  BIT	      C8	  81
CT2				  BIT	      C9	  82
CY				  BIT	      D7	  95
DATABUS				  NUMBER    0090	 181
DP0H				  DATA	      83	   9
DP0L				  DATA	      82	   8
DP1H				  DATA	      85	  11
DP1L				  DATA	      84	  10
DPH				  NUMBER    0083	 190
DPL				  NUMBER    0082	 189
DUMPRAM				  CODE	    60DA	 327
DUMPRAM1			  CODE	    60F1	 337
DUMPRAM2			  CODE	    60DD	 328
EA				  BIT	      AF	  66
ERALL				  NUMBER    005C	 131
ERROR				  CODE	    61C0	 525
ES				  BIT	      AC	  64
ESC				  NUMBER    003E	 117
ET0				  BIT	      A9	  61
ET1				  BIT	      AB	  63
ET2				  BIT	      AD	  65
EX0				  BIT	      A8	  60
EX1				  BIT	      AA	  62
EXEN2				  BIT	      CB	  84
EXF2				  BIT	      CE	  87
EXTI0				  CODE	    0003	  98
EXTI1				  CODE	    0013	 100
F0				  BIT	      D5	  93
FIND				  NUMBER    005F	 132
GHEX				  NUMBER    003A	 113
GHEX16				  NUMBER    003C	 115
HIGHRES				  CODE	    6193	 487
IE				  DATA	      A8	  26
IE0				  BIT	      89	  40
IE1				  BIT	      8B	  42

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 14



SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
INIT6845			  CODE	    6147	 404
INIT6845HI			  CODE	    6133	 391
INT0				  BIT	      B2	  69
INT1				  BIT	      B3	  70
INTADD				  NUMBER    982C	 159
INTADD4				  NUMBER    982A	 158
INTCLR				  NUMBER    9830	 161
INTCLR4				  NUMBER    982E	 160
INTCMP				  NUMBER    981C	 151
INTCMP4				  NUMBER    981A	 150
INTCOPY				  NUMBER    9822	 154
INTCOPY2			  NUMBER    981E	 152
INTCOPY4			  NUMBER    9820	 153
INTDIV3				  NUMBER    9816	 148
INTDUMP				  NUMBER    983E	 170
INTDUMP2			  NUMBER    983C	 169
INTDUMP4			  NUMBER    983A	 168
INTDUMP6			  NUMBER    9838	 167
INTFILL				  NUMBER    9832	 162
INTMUL4				  NUMBER    9818	 149
INTSUB				  NUMBER    9828	 157
INTSUB2				  NUMBER    9824	 155
INTSUB4				  NUMBER    9826	 156
IP				  DATA	      B8	  28
IT0				  BIT	      88	  39
IT1				  BIT	      8A	  41
LENSTR				  NUMBER    004A	 125
LOCAT				  NUMBER    6000	 192
LOOP				  CODE	    6200	 587
MEMCLR				  NUMBER    980A	 141
MEMCLR4				  NUMBER    9808	 140
MEMCMP				  NUMBER    980E	 143
MEMCOPY				  NUMBER    9842	 174
MEMCOPY4			  NUMBER    9846	 176
MEMDUMP				  NUMBER    9844	 175
MEMDUMP128			  NUMBER    9804	 138
MEMDUMP2			  NUMBER    9800	 136
MEMDUMP4			  NUMBER    9802	 137
MEMDUMP512			  NUMBER    9806	 139
MEMFILL				  NUMBER    980C	 142
MEMINTA2			  NUMBER    9836	 165
MEMINTA4			  NUMBER    9834	 164
MEMINTC				  NUMBER    9814	 146
MEMINTC2			  NUMBER    9810	 144
MEMINTC4			  NUMBER    9812	 145
MISO				  BIT	      96	  50
MOSI				  BIT	      95	  49
NEWLINE				  NUMBER    0048	 124
OV				  BIT	      D2	  90
P				  BIT	      D0	  89
P0				  DATA	      80	   6
P1				  DATA	      90	  20
P2				  DATA	      A0	  23
P3				  DATA	      B0	  27
PCON				  DATA	      87	  12
PCSTR				  NUMBER    0045	 122

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 15



SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
PCSTR_H				  NUMBER    0045	 123
PHEX				  NUMBER    0034	 108
PHEX1				  NUMBER    002E	 105
PHEX16				  NUMBER    0036	 109
PINT16U				  NUMBER    0053	 128
PINT8				  NUMBER    0050	 127
PINT8U				  NUMBER    004D	 126
PRGM				  NUMBER    0059	 130
PS				  BIT	      BC	  79
PSTR				  NUMBER    0038	 110
PSTRR7				  NUMBER    9848	 177
PSW				  DATA	      D0	  35
PT0				  BIT	      B9	  76
PT1				  BIT	      BB	  78
PT2				  BIT	      BD	  80
PX0				  BIT	      B8	  75
PX1				  BIT	      BA	  77
RB8				  BIT	      9A	  54
RCAP2H				  DATA	      CB	  32
RCAP2L				  DATA	      CA	  31
RCLK				  BIT	      CD	  86
RD				  BIT	      B7	  74
READPAGE			  CODE	    61E7	 559
REGS				  CODE	    6085	 276
REGS1				  CODE	    60A7	 294
REGS2				  CODE	    60AD	 297
REGS3				  CODE	    609E	 290
REGS4				  CODE	    608F	 281
REGSSET				  CODE	    60B3	 300
REN				  BIT	      9C	  56
RESET				  CODE	    0000	  97
RI				  BIT	      98	  52
RS0				  BIT	      D3	  91
RS1				  BIT	      D4	  92
RXD				  BIT	      B0	  67
SBUF				  DATA	      99	  22
SCK				  BIT	      97	  51
SCON				  DATA	      98	  21
SCROLUP				  CODE	    6061	 248
SCROLUP1			  CODE	    606D	 255
SCROLUP2			  CODE	    606B	 253
SCROLUP3			  CODE	    6080	 270
SETREGS				  CODE	    6158	 414
SINT				  CODE	    0023	 102
SM0				  BIT	      9F	  59
SM1				  BIT	      9E	  58
SM2				  BIT	      9D	  57
SMART_WR			  NUMBER    0056	 129
SP				  DATA	      81	   7
SPACE				  CODE	    6218	 608
START				  CODE	    6040	 210
START2				  CODE	    604D	 235
START3				  CODE	    6059	 244
STRCOPY				  NUMBER    984A	 179
SYCS				  NUMBER    00B2	 183
SYDATA				  CODE	    617F	 465

ASEM-51 V1.3                                        Copyright (c) 2002 by W.W. Heinz                                         PAGE 16



SYMBOL				  TYPE     VALUE	LINE
------------------------------------------------------------
SYPHI2				  NUMBER    00B4	 185
SYRS				  NUMBER    00B3	 184
SYRW				  NUMBER    00B5	 186
T0				  BIT	      B4	  71
T1				  BIT	      B5	  72
T2				  BIT	      90	  47
T2CON				  DATA	      C8	  29
T2EX				  BIT	      91	  48
T2MOD				  DATA	      C9	  30
TB8				  BIT	      9B	  55
TCLK				  BIT	      CC	  85
TCON				  DATA	      88	  13
TESTLOOP			  CODE	    61AD	 514
TESTLOOP1			  CODE	    61B1	 516
TESTRAM				  CODE	    61A7	 509
TESTSCREEN			  CODE	    60F7	 341
TESTSCREEN1			  CODE	    6100	 346
TESTSCREEN2			  CODE	    610D	 358
TESTSCREEN3			  CODE	    60FC	 344
TF0				  BIT	      8D	  44
TF1				  BIT	      8F	  46
TF2				  BIT	      CF	  88
TH0				  DATA	      8C	  17
TH1				  DATA	      8D	  18
TH2				  DATA	      CD	  34
TI				  BIT	      99	  53
TIME				  CODE	    620D	 595
TIME1				  CODE	    6211	 597
TIMER0				  CODE	    000B	  99
TIMER1				  CODE	    001B	 101
TIMER2				  CODE	    002B	 103
TL0				  DATA	      8A	  15
TL1				  DATA	      8B	  16
TL2				  DATA	      CC	  33
TMOD				  DATA	      89	  14
TP0				  CODE	    61D5	 539
TP1				  CODE	    61EB	 561
TR0				  BIT	      8C	  43
TR1				  BIT	      8E	  45
TR2				  BIT	      CA	  83
TXD				  BIT	      B1	  68
UPPER				  NUMBER    0040	 119
WDTRST				  DATA	      A6	  25
WR				  BIT	      B6	  73
WRITEPAGE			  CODE	    61C1	 529
